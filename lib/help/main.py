#!/usr/bin/python3
import os
import sys
import asyncio
import argparse
import importlib

DESCRIPTION="HELP : Get help"

def list_modules():
    return sorted(os.listdir(os.path.realpath(os.path.dirname(os.path.abspath(__file__)) + "/../")))

def parse_args():
    parser = argparse.ArgumentParser(description=DESCRIPTION, formatter_class=argparse.ArgumentDefaultsHelpFormatter)
    return dict(vars(parser.parse_args()))
 
async def run():
    modules = list_modules()
    cli = (" ".join(" ".join(sys.argv).split(" ")[:-1]))
    print("USAGE: ")
    print("")
    print("    " + cli + " <module>")
    print("")
    print("AVAILABLE MODULES: ")
    for module in modules: 
        print("")
        print("    " + module)
        module = importlib.import_module('lib.' + module + ".main")
        description = getattr(module, "DESCRIPTION")
        print("        " + description)
        print("")


if __name__ == "__main__":
    parent_dir = os.path.abspath(os.path.join(os.path.dirname(__file__), '..'))
    sys.path.insert(0, parent_dir)

    args = parse_args()
    asyncio.run(run(**args))


